# scClustViz
An interactive R Shiny tool for visualizing single-cell RNAseq clustering results from the *Seurat* R package or any other analysis pipeline.  Its main goal is to help select a biologically appropriate resolution or K from clustering results by assessing differential expression between the resulting clusters.  

-   [Usage](#usage)
-   [scRNAseq analysis pipeline](#scrnaseq-analysis-pipeline)
-   [Contact](#contact)

## Usage
scClustViz is distributed as a collection of R scripts rather than a package for ease of customization and integration into your existing analysis pipeline.  Running the visualization tool requires a one-time setup step, then it's just a matter of running a single R script.  
### Setup
To set up the files necessary, download and run [PrepareInputs.R](PrepareInputs.R).  Note that you will need to change some of the variables in the script to reflect your data/computer, as well as installing any missing libraries.  This script is designed to take your *Seurat* output and generate all the differential expression information necessary for the visualization tool, which will be saved in a directory of your choosing.  If you have your analysis outputs in another format (i.e. Bioconductor's SingleCellExperiment class), you can use the code used to pull the relevant bits out of the *Seurat* object as a template for loading your data into the visualization tool.  I aim to include automatic loading for the SingleCellExperiment class shortly, but in the meantime you can check out [iSEE](https://bioconductor.org/packages/release/bioc/html/iSEE.html) if you'd prefer not to deal with it yourself.  
### Run
After you've run PrepareInputs.R, download both [App.R](App.R) and [RunVizScript.R](RunVizScript.R).  You will again need to change some variables and install any missing libraries in RunVizScript.R.  You shouldn't need to touch App.R unless you're interested in modifying the Shiny visualization itself.  Running RunVizScript.R will load your data into the visualization software, and will open the Shiny UI in a web browser.  Have fun exploring your data!

## scRNAseq analysis pipeline
I've also included my current basic pipeline for scRNAseq analysis from data generated by a 10X Genomics Chromium and processed using 10X Genomics CellRanger.  The quality control and normalization steps are based to some extent on the [workflow](http://dx.doi.org/10.12688/f1000research.9501.2) proposed by the Marioni group using their [*scran* package](http://bioconductor.org/packages/release/bioc/html/scran.html), and the clustering is done using the algorithm implemented in the Satija lab's [*Seurat* package](https://satijalab.org/seurat/).  I've set the pipeline up as R notebooks so that they generate convenient reports as they run.  Here's an example using [sample data from 10X genomics](https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/neurons_900).  Note that if you use this pipeline to process your data, you can load the output straight into [RunVizScript.R](RunVizScript.R) and skip the [PrepareInputs.R](PrepareInputs.R) processing step.  
-   [Quality Control & Normalization](pipeline_QCN.md) or a [pdf report](pipeline_QCN.pdf), and download the [R notebook](pipeline_QCN.Rmd) (RStudio required).  
-   [Clustering and DE analysis](pipeline_Clust.md) or a [pdf report](pipeline_Clust.pdf), and download the [R notebook](pipeline_Clust.Rmd) (RStudio required).  

### Contact
You can [contact me](http://www.baderlab.org/BrendanInnes) for questions about this repo.  For general scRNAseq questions, do what I do and [ask the Toronto single-cell RNAseq working group on Slack](http://bit.ly/scRNAseqTO)!  



