# scClustViz
An interactive R Shiny tool for visualizing single-cell RNAseq clustering results from the *Seurat* analysis package, or any other analysis pipeline.  Its main goal is to help select a biologically appropriate resolution or K from clustering results by assessing differential expression between the resulting clusters.  

-   [Installation](#installation)
-   [scRNAseq analysis pipeline](#scrnaseq-analysis-pipeline)

### Installation
scClustViz is distributed as a collection of R scripts rather than a package for ease of customization and integration into your existing analysis pipeline.  Running the visualization tool requires a one-time setup step, then it's just a matter of running a single R script.  
To set up the files necessary, download and run [PrepareInputs.R](PrepareInputs.R).  Note that you will need to change some of the variables in the script to reflect your data/computer, as well as installing any missing libraries.  This script is designed to take your Seurat output and generate all the differential expression information necessary for the visualization tool, which will be saved in a directory of your choosing.  
After you've run [PrepareInputs.R](PrepareInputs.R), download both [App.R](App.R) and [RunVizScript.R](RunVizScript.R).  You will again need to change some variables and install any missing libraries in [RunVizScript.R](RunVizScript.R).  You shouldn't need to touch [App.R](App.R) unless you're interested in modifying the Shiny visualization itself.  Running [RunVizScript.R](RunVizScript.R) will load your data into the visualization software, and will open the Shiny UI in a web browser.  Have fun exploring your data!

### scRNAseq analysis pipeline
I've also included my current basic pipeline for scRNAseq analysis from data generated by a 10X Genomics Chromium and processed using 10X Genomics CellRanger.  The quality control and normalization steps are based to some extent on the workflow proposed by the Marioni group in http://dx.doi.org/10.12688/f1000research.9501.2 using their *scran* package, and the clustering is done using the algorithm implemented in the Satija lab's *Seurat* package (https://satijalab.org/seurat/).  I've set the pipeline up as R notebooks so that they generate convenient reports as they run.  Here's an example using data from 10X genomics (https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/neurons_900).  Note that if you use this pipeline to process your data, you can load the output straight into [RunVizScript.R](RunVizScript.R) and skip the [PrepareInputs.R](PrepareInputs.R) processing step.  
[Quality Control & Normalization](pipeline_QCN.md) or a [pdf report](pipeline_QCN.pdf)  
[Clustering and DE analysis](pipeline_clust.md) or a [pdf report](pipeline_clust.pdf)  

Special thanks to the Toronto single-cell RNAseq working group.  If you're interested in joining the discussion on Slack, go to http://bit.ly/scRNAseqTO  


